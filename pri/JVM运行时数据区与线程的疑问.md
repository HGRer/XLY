# JVM运行时数据区与线程的疑问

## 问题所在

我认为线程对象本身包含了操作系统调用所需的信息，但是JVM的拥有数个数据区，我不知道在JVM中线程是在哪里存放“操作系统调用所需的信息”的。

## 前提知识

### 1.CPU执行代码的顺序。

CPU会从内存中取出指令 -> 解码.... -> 执行。记住，线程是操作系统调度的基本单位，那么“CPU从内存中取出指令”，其实是由线程提供的数据，告诉CPU要执行的指令。

### 2.操作系统中线程的数据结构。

-《现代操作系统》中描述的经典的线程模型：程序计数器，寄存器，堆栈，状态

-《CSAPP》中描述的线程模型：ThreadID，栈，栈指针，程序计数器，通用目的寄存器，条件码

### 3.JVM运行时数据区的结构

线程共享：方法区，堆，执行引擎，本地库接口

线程独占：VM STACK，native methond stack，程序计数器

其中VM STACK是保存着栈帧，每个栈帧代表一次方法调用。每个栈帧的数据结构又包含了：局部变量表，操作数栈，动态链接，方法返回地址，附加信息。其中操作数栈的功能和经典线程模型中的堆栈功能相似，都是存放着被调用方法的字节码指令顺序。

## 解疑

现在了解到，JVM的运行时数据区也是模仿了操作系统MMU之类的结构。回到《问题所在》，Java中的线程Thread对象，JVM会给这个对象分配栈帧地址，程序计数器地址等等，跟操作系统的结构类似。理解了操作系统中的线程的数据结构各含义是什么，也初步理解JVM划分运行时数据区的含义及JVM对Thread对象的各个数据存放在哪里。